<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scope</title>

    //<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script type="module">


        //import * as THREE from 'https://threejsfundamentals.org/threejs/resources/threejs/r119/build/three.module.js';
        import * as THREE from './three.module.js';
       // import {Fog} from "./three.module.js";
       // import {FogExp2} from "./three.module.js";
        import { GLTFLoader } from './GLTFMod.js';





        function initC(idStr,colStr,l,w,t,h) {

            $("#"+idStr).css({

                "background-color":colStr,
                "position":"absolute",
                "left":l+"%",
                "width":w+"%",
                "top":t+"%",
                "height":h+"%",
                "visibility": "visible",
            })



        };



        $(document).ready(function () {

            /*

            $("#blue").css({
                "background-color": "LightGray",
                "position":"absolute",
                "left":"20%",
                "width":"50%",
                "top":"5%",
                "height":"50%"




            });
           */






            initC("mainPanel","Gray",5,90,5,90);
            initC("c","Black",5,90,5,45);
            initC("rangePanel","LightGray",2,68,62,16);
            initC("buttonPanel","LightGray",72,26,62,16);



            initC("R1","Orange",20,60,15,15);
            $("#R1").attr("step","0.1");
            initC("NR1","LightGreen",2,16,15,15);
            initC("VR1","LightGreen",85,10,15,15);

            //next lines 3js Ev 1 -----

            $("#NR1").text("Rot Speed");
            //$("#NR1").text("R1");
            //$("#NR1").text("R1");
            $("#VR1").text("Arb");
            //$("#VR1").text($("#R1").val());
            // $("#R1").on("input",function(){ $("#VR1").text($("#R1").val())});
            // -----

            initC("R2","Orange",10,70,30,15);
            $("#R2").attr("step","0.1");
            initC("NR2","LightGreen",2,6,30,15);
            initC("VR2","LightGreen",85,10,30,15);
            $("#NR2").text("R2");
            $("#VR2").text($("#R2").val());
            $("#R2").on("input",function(){ $("#VR2").text($("#R2").val())});

            initC("R3","Orange",10,70,45,15);
            $("#R3").attr("step","0.1");
            initC("NR3","LightGreen",2,6,45,15);
            initC("VR3","LightGreen",85,10,45,15);
            $("#NR3").text("R3");
            $("#VR3").text($("#R3").val());
            $("#R3").on("input",function(){ $("#VR3").text($("#R3").val())});


            initC("B1","LightBlue",4,20,5,15);
            initC("B2","LightBlue",28,20,5,15);
            initC("B3","LightBlue",52,20,5,15);
            initC("B4","LightBlue",76,20,5,15);

            $("#B1").text("B1");
            $("#B1").click(function(){alert("button B1 pressed");});//insert action or call func

            $("#B2").text("B2");
            $("#B2").click(function(){alert("button B2 pressed");});//insert action or call func


            $("#B3").text("B3");
            $("#B3").click(function(){alert("button B3 pressed");});//insert action or call func

            $("#B4").text("B4");
            $("#B4").click(function(){alert("button B4 pressed");});//insert action or call func



            //3js Ev1 ------
            // example based on 3js web site intro tutorial
            //https://threejsfundamentals.org/threejs/lessons/threejs-fundamentals.html

            var loader = new GLTFLoader();



            let canvas = document.querySelector('#c');
            let renderer = new THREE.WebGLRenderer({canvas});

            let zpos = 50;
            let xpos = 0;

            //*****CAMERA*****
            let fov = 75;
            let aspect = 2;  // the canvas default
            let near = 0.05;
            let far = 500;
            let camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
            camera.position.z = 10;
           // camera.position.z = .5;
            camera.position.x = 0;
            // camera.position.x = 6;











            //*****SCENE AND LIGHTS*****

            let scene = new THREE.Scene();
            let myObj = new THREE.Object3D();
            var myDuck;

           // loader.load( './Duck.glb', function(gltf) {
                loader.load( './sphere1.glb', function(gltf) {

                //scene.add(gltf.scene);
                myObj.add(gltf.scene);
                //scene.add(myDuck);

            }, undefined, function (error){
                console.error(error);

            });
            myObj.scale.set(0.003,0.003,0.003);
            scene.add(myObj);
            myObj.position.y = -1;

            let aFog = new THREE.FogExp2(0xFF0000,0.075);

            //scene.fog = aFog;

            {
                let color = 0xFFFFFF;
                let intensity = 1;
                let light = new THREE.DirectionalLight(color, intensity);
                light.position.set(-1, 2, 4);
               // scene.add(light);
            }

            var spotLight = new THREE.SpotLight(0xFFFFFF);
            spotLight.position.set(4, 4, 4);
            spotLight.castShadow = true;
            spotLight.shadow.mapSize = new THREE.Vector2(4096, 4096);
            spotLight.shadow.camera.far = 500;
            spotLight.shadow.camera.near = 0.5;

            // If you want a more detailled shadow you can increase the
            // mapSize used to draw the shadows.
            // spotLight.shadow.mapSize = new THREE.Vector2(1024, 1024);
           scene.add(spotLight);

            var helper = new THREE.CameraHelper( spotLight.shadow.camera );
            scene.add( helper )

            var ambienLight = new THREE.AmbientLight(0xFF0000);
            scene.add(ambienLight);


            //***** PARAMETRIC EXPTS *****



            var w = 10; var d = 20;

            function fPlane(u,v, vec) {
                 vec.x = (4+0.3*v) * Math.cos(6.28*u); // + 0.1*Math.cos(6.28*v);
                 vec.y = (4+0.3 *v) *Math.sin(6.28*u); //  +0.1 *Math.sin(6.28*v) ;
                 vec.z =  1.0; // * Math.random()*v ;
            }

            var geometryPar = new THREE.ParametricGeometry(fPlane,100,5);
            var  materialPar = new THREE.MeshPhongMaterial( { color: 0xffffff, wireframe:true } );

            var aParameterThing = new THREE.Mesh( geometryPar, materialPar );
            aParameterThing.material.side = THREE.DoubleSide;
            scene.add( aParameterThing );

            //*****CUBE*****

            let boxWidth = 1;
            let boxHeight = 1;
            let boxDepth = 1;
            let geometry = new THREE.BoxGeometry(boxWidth, boxHeight, boxDepth);
            let material = new THREE.MeshLambertMaterial({ color: 0x44aa88});  // greenish blue
            let cube = new THREE.Mesh(geometry, material);
            cube.castShadow = true;
            let rot =0;
            let divider =0;


          // scene.add(cube);

            let cube2 = new THREE.Mesh(geometry.clone(), material.clone());
            cube2.position.x = -2;
            cube2.material.color.set(0x0000FF);
            cube2.castShadow = true;

            scene.add(cube2);

            //*****AXES*****


            var axes = new THREE.AxesHelper(3);
            scene.add(axes);


            //*****PLANE*****
            // create the ground plane
            var planeGeometry = new THREE.PlaneGeometry(8, 8);
            let planeMaterial = new THREE.MeshLambertMaterial({
                color: 0xCCCCCC,
                transparent: true, opacity: 0.33
            });
           // var planeMaterial = new THREE.MeshBasicMaterial({
           //     color: 0xAAAAAA,
            //    wireframe: false,
              //  transparent: true, opacity: 0.3
           // });
            var plane = new THREE.Mesh(planeGeometry, planeMaterial);
           plane.receiveShadow = true;
            plane.material.side = THREE.DoubleSide;

            // rotate and position the plane
            plane.rotation.x = 0;// -0.4 * Math.PI;
            plane.rotation.z = 0; //-0.3 * Math.PI;
            plane.position.set(0, 0, 0);

            // add the plane to the scene
            scene.add(plane);


/* show BufferGeometry - need to adjust camera pos so x, y near to 1.
            var geometryL = new THREE.BufferGeometry();
// create a simple square shape. We duplicate the top left and bottom right
// vertices because each vertex needs to appear once per triangle.
            var vertices = new Float32Array( [
                -1.0, -1.0,  1.0,
                1.0, -1.0,  1.0,
                1.0,  1.0,  1.0,

                1.0,  1.0,  1.0,
                -1.0,  1.0,  1.0,
                -1.0, -1.0,  1.0
            ] );

// itemSize = 3 because there are 3 values (components) per vertex
            geometryL.setAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );
            var materialL = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
            var meshL = new THREE.Mesh( geometryL, materialL );
            scene.add(meshL);
*/

            //*****RENDER SETUP*****

            renderer.setClearColor(new THREE.Color(0x000000));
            renderer.shadowMap.enabled = true;
            renderer.render(scene, camera);


            function resizeRendererToDisplaySize(renderer) {
                const canvas = renderer.domElement;
                const width = canvas.clientWidth;
                const height = canvas.clientHeight;
                const needResize = canvas.width !== width || canvas.height !== height;
                if (needResize) {
                    renderer.setSize(2 * width,2 * height, false);
                }
                return needResize;
            }

            //****MAIN RENDER FUNCTION*****
            function  render(time) {
                //removed example code using time
                //as I want to use a slider
                //time *= 0.001;  // convert time to seconds

                // prevent divider becoming zero by adding 1
                //as slider min = zero

                //camera.aspect = canvas.clientWidth / canvas.clientHeight;
                //camera.updateProjectionMatrix();
                if (resizeRendererToDisplaySize(renderer)) {
                    const canvas = renderer.domElement;
                    camera.aspect = canvas.clientWidth / canvas.clientHeight;
                    camera.updateProjectionMatrix();
                }




                divider = 1 + parseFloat($("#R1").val());
                zpos = 20 * parseFloat($("#R2").val());
                camera.position.z = zpos;

                xpos =  -10 + 2 * parseFloat($("#R3").val());
                camera.position.x = xpos;

                rot += (0.02 / divider);
                myObj.rotation.y =  rot/5 ;
                //cube.rotation.x = rot/10;
                aParameterThing.rotation.y = rot/10;
                //aParameterThing.rotation.x =rot/10;
                //aParameterThing.rotation.z = rot/20;
                cube.position.x += 0.0005;
                cube.position.z -= 0.0005;
                plane.rotation.x = rot/2;

                renderer.render(scene, camera);

                requestAnimationFrame(render);
            }

            //*****START RENDERER FUNCTION*****

            requestAnimationFrame(render);

            //-----


        });//******END READY FUNCTION*****

    </script>
    <script src="01-02.js"></script>

</head>
<body>

<div id="mainPanel" style="visibility:hidden">

    <canvas id="c" width="800" height="400"></canvas>

    <div id="rangePanel" >
        <input type="range" id="R1" name="range1" min="0" max="10">
        <div id="NR1"></div>
        <div id="VR1"></div>
        <input type="range" id="R2" name="range2" min="0" max="10">
        <div id="NR2"></div>
        <div id="VR2"></div>
        <input type="range" id="R3" name="range3" min="0" max="10">
        <div id="NR3"></div>
        <div id="VR3"></div>
    </div>

    <div id="buttonPanel">
        <button id="B1" name="button1"></button>
        <button id="B2" name="button2"></button>
        <button id="B3" name="button3"></button>
        <button id="B4" name="button4"></button>
    </div>

</div>
</body>
</html>